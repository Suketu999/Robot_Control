function dz = ode_progassn(t,z)
m1=1;m2=1;l1=1;l2=1;r1=0.45;r2=0.45;I1=0.084;I2=0.084;g=9.81;
dz=zeros(4,1);
z=num2cell(z);
[t1, t2, t1_dot, t2_dot] = deal(z{:});

if abs(t1)>2*pi
    t1 = mod(t1, 2*pi);
end

if abs(t2)>2*pi
    t2 = mod(t2, 2*pi);
end

u1 = 0;
u2 = 0;
dz(1) = t1_dot;
dz(2) = t2_dot;
dz(3) = (u1*conj(I2) - u2*conj(I2) + u1*conj(m2)*conj(r2)^2 - u2*conj(m2)*conj(r2)^2 - sin(conj(t2))*conj(g)*conj(m2)^2*conj(r2)^3 + sin(conj(t2))*conj(l1)*conj(m2)^2*conj(r2)^3*conj(t1_dot)^2 - u2*cos(conj(t2))*conj(l1)*conj(m2)*conj(r2) + sin(conj(t1))*conj(g)*conj(l1)*conj(m2)^2*conj(r2)^2 + sin(conj(t1))*conj(I2)*conj(g)*conj(l1)*conj(m2) + sin(conj(t1))*conj(I2)*conj(g)*conj(m1)*conj(r1) - sin(conj(t2))*conj(I2)*conj(g)*conj(m2)*conj(r2) + sin(conj(t2))*conj(I2)*conj(l1)*conj(m2)*conj(r2)*conj(t1_dot)^2 + sin(conj(t1))*conj(g)*conj(m1)*conj(m2)*conj(r1)*conj(r2)^2 + t2_dot*sin(conj(t2))*conj(l1)*conj(m2)^2*conj(r2)^3*conj(t1_dot) + t2_dot*sin(conj(t2))*conj(l1)*conj(m2)^2*conj(r2)^3*conj(t2_dot) + sin(conj(t2))*conj(l1)*conj(m2)^2*conj(r2)^3*conj(t1_dot)*conj(t2_dot) + cos(conj(t2))*sin(conj(t2))*conj(l1)^2*conj(m2)^2*conj(r2)^2*conj(t1_dot)^2 - cos(conj(t2))*sin(conj(t2))*conj(g)*conj(l1)*conj(m2)^2*conj(r2)^2 + t2_dot*sin(conj(t2))*conj(I2)*conj(l1)*conj(m2)*conj(r2)*conj(t1_dot) + t2_dot*sin(conj(t2))*conj(I2)*conj(l1)*conj(m2)*conj(r2)*conj(t2_dot) + cos(conj(t2))*sin(conj(t2))*conj(l1)^2*conj(m2)^2*conj(r2)^2*conj(t1_dot)*conj(t2_dot) + sin(conj(t2))*conj(I2)*conj(l1)*conj(m2)*conj(r2)*conj(t1_dot)*conj(t2_dot) - t2_dot*cos(conj(t2))*sin(conj(t2))*conj(l1)^2*conj(m2)^2*conj(r2)^2*conj(t1_dot))/(- cos(conj(t2))^2*conj(l1)^2*conj(m2)^2*conj(r2)^2 + conj(l1)^2*conj(m2)^2*conj(r2)^2 + conj(I2)*conj(l1)^2*conj(m2) + conj(m1)*conj(m2)*conj(r1)^2*conj(r2)^2 + conj(I1)*conj(m2)*conj(r2)^2 + conj(I2)*conj(m1)*conj(r1)^2 + conj(I1)*conj(I2));
dz(4) = -(u1*conj(I2) - u2*conj(I1) - u2*conj(I2) - u2*conj(l1)^2*conj(m2) - u2*conj(m1)*conj(r1)^2 + u1*conj(m2)*conj(r2)^2 - u2*conj(m2)*conj(r2)^2 - sin(conj(t2))*conj(g)*conj(m2)^2*conj(r2)^3 + sin(conj(t2))*conj(l1)*conj(m2)^2*conj(r2)^3*conj(t1_dot)^2 + sin(conj(t2))*conj(l1)^3*conj(m2)^2*conj(r2)*conj(t1_dot)^2 + u1*cos(conj(t2))*conj(l1)*conj(m2)*conj(r2) - 2*u2*cos(conj(t2))*conj(l1)*conj(m2)*conj(r2) + sin(conj(t1))*conj(g)*conj(l1)*conj(m2)^2*conj(r2)^2 - sin(conj(t2))*conj(g)*conj(l1)^2*conj(m2)^2*conj(r2) + sin(conj(t1))*conj(I2)*conj(g)*conj(l1)*conj(m2) + sin(conj(t1))*conj(I2)*conj(g)*conj(m1)*conj(r1) - sin(conj(t2))*conj(I1)*conj(g)*conj(m2)*conj(r2) - sin(conj(t2))*conj(I2)*conj(g)*conj(m2)*conj(r2) + sin(conj(t2))*conj(I1)*conj(l1)*conj(m2)*conj(r2)*conj(t1_dot)^2 + sin(conj(t2))*conj(I2)*conj(l1)*conj(m2)*conj(r2)*conj(t1_dot)^2 + sin(conj(t1))*conj(g)*conj(m1)*conj(m2)*conj(r1)*conj(r2)^2 - sin(conj(t2))*conj(g)*conj(m1)*conj(m2)*conj(r1)^2*conj(r2) + t2_dot*sin(conj(t2))*conj(l1)*conj(m2)^2*conj(r2)^3*conj(t1_dot) - t2_dot*sin(conj(t2))*conj(l1)^3*conj(m2)^2*conj(r2)*conj(t1_dot) + t2_dot*sin(conj(t2))*conj(l1)*conj(m2)^2*conj(r2)^3*conj(t2_dot) + sin(conj(t2))*conj(l1)*conj(m2)^2*conj(r2)^3*conj(t1_dot)*conj(t2_dot) + sin(conj(t2))*conj(l1)^3*conj(m2)^2*conj(r2)*conj(t1_dot)*conj(t2_dot) + 2*cos(conj(t2))*sin(conj(t2))*conj(l1)^2*conj(m2)^2*conj(r2)^2*conj(t1_dot)^2 + cos(conj(t2))*sin(conj(t1))*conj(g)*conj(l1)^2*conj(m2)^2*conj(r2) - 2*cos(conj(t2))*sin(conj(t2))*conj(g)*conj(l1)*conj(m2)^2*conj(r2)^2 - t2_dot*sin(conj(t2))*conj(I1)*conj(l1)*conj(m2)*conj(r2)*conj(t1_dot) + t2_dot*sin(conj(t2))*conj(I2)*conj(l1)*conj(m2)*conj(r2)*conj(t1_dot) + t2_dot*sin(conj(t2))*conj(I2)*conj(l1)*conj(m2)*conj(r2)*conj(t2_dot) + 2*cos(conj(t2))*sin(conj(t2))*conj(l1)^2*conj(m2)^2*conj(r2)^2*conj(t1_dot)*conj(t2_dot) + sin(conj(t2))*conj(l1)*conj(m1)*conj(m2)*conj(r1)^2*conj(r2)*conj(t1_dot)^2 + sin(conj(t2))*conj(I1)*conj(l1)*conj(m2)*conj(r2)*conj(t1_dot)*conj(t2_dot) + sin(conj(t2))*conj(I2)*conj(l1)*conj(m2)*conj(r2)*conj(t1_dot)*conj(t2_dot) + t2_dot*cos(conj(t2))*sin(conj(t2))*conj(l1)^2*conj(m2)^2*conj(r2)^2*conj(t2_dot) - t2_dot*sin(conj(t2))*conj(l1)*conj(m1)*conj(m2)*conj(r1)^2*conj(r2)*conj(t1_dot) + cos(conj(t2))*sin(conj(t1))*conj(g)*conj(l1)*conj(m1)*conj(m2)*conj(r1)*conj(r2) + sin(conj(t2))*conj(l1)*conj(m1)*conj(m2)*conj(r1)^2*conj(r2)*conj(t1_dot)*conj(t2_dot))/(- cos(conj(t2))^2*conj(l1)^2*conj(m2)^2*conj(r2)^2 + conj(l1)^2*conj(m2)^2*conj(r2)^2 + conj(I2)*conj(l1)^2*conj(m2) + conj(m1)*conj(m2)*conj(r1)^2*conj(r2)^2 + conj(I1)*conj(m2)*conj(r2)^2 + conj(I2)*conj(m1)*conj(r1)^2 + conj(I1)*conj(I2));

end